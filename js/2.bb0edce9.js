(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"713b":function(e,t,n){"use strict";n.r(t);var a,r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-layout",{attrs:{view:"hHh Lpr lFf"}},[n("q-header",[n("q-toolbar",{staticClass:"bg-white text-primary shadow-up-12"},[n("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu"},on:{click:function(t){e.leftDrawerOpen=!e.leftDrawerOpen}}}),n("q-toolbar-title",[e._v("\n        Steel Microstructure Classifier\n      ")]),n("div",[e._v("v"+e._s(e.$q.version)+" | "),n("a",{attrs:{target:"_blank",href:"https://trinly01.github.io"}},[e._v("Trinmar Boado")])])],1)],1),n("q-drawer",{attrs:{"show-if-above":"",bordered:"","content-class":"bg-grey-1"},model:{value:e.leftDrawerOpen,callback:function(t){e.leftDrawerOpen=t},expression:"leftDrawerOpen"}},[n("q-list",[n("q-item-label",{staticClass:"text-grey-8",attrs:{header:""}},[e._v("\n        Essential Links\n      ")]),n("div",{staticClass:"column q-pa-md"},e._l(e.tags,(function(t,a){return n("q-checkbox",{key:"tag"+a,attrs:{label:t.label},model:{value:t.value,callback:function(n){e.$set(t,"value",n)},expression:"tag.value"}})})),1)],1),n("q-list",{staticClass:"menu-list absolute-bottom",staticStyle:{bottom:"8px"}},[n("q-separator"),n("q-item",{staticClass:"bg-grey-12 text-justify text-caption column"},[e._v("\n        Classifying the Steel Microstructure from Metallographic Images Using Convolutional Neural Network\n      ")])],1)],1),n("q-page-container",[n("q-toolbar",{staticClass:"bg-white text-primary shadow-up-12"},[n("input",{ref:"uploader",attrs:{type:"file",hidden:"",accept:"image/jpeg,image/png"},on:{change:e.upload}}),n("q-btn",{attrs:{stretch:"",flat:"",icon:"add",label:"Add image"},on:{click:function(){e.$refs.uploader.value="",e.$refs.uploader.click()}}}),n("q-btn",{attrs:{stretch:"",flat:"",disabled:!e.filteredImages.filter((function(e){return e.selected})).length,icon:"delete",label:"Delete"},on:{click:e.remove}}),e.filteredImages.filter((function(e){return e.selected})).length?n("q-btn",{attrs:{stretch:"",flat:"",label:"Unselect All"},on:{click:function(t){return e.images.filter((function(e){return e.selected=!1}))}}}):n("q-btn",{attrs:{stretch:"",flat:"",label:"Select All"},on:{click:function(t){return e.images.filter((function(e){return e.selected=!0}))}}}),n("q-space"),n("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"more_vert"}})],1),n("div",{class:"row q-pa-md "+(e.images.length>2||!e.images.length?"flex-center":""),attrs:{"style-fn":function(e){return{minHeight:"calc(100vh - 100px)"}}}},[n("center",{directives:[{name:"show",rawName:"v-show",value:!e.images.length,expression:"!images.length"}],style:{paddingTop:"calc(50vh - 150px)"}},[n("q-btn",{attrs:{stretch:"",icon:"add",label:"Add image",color:"primary"},on:{click:function(){e.$refs.uploader.value="",e.$refs.uploader.click()}}})],1),e._l(e.filteredImages,(function(t,a){return n("q-card",{key:"img"+a,staticClass:"q-ma-md",staticStyle:{"max-height":"175px",width:"230px"},on:{mouseover:function(n){e.hover=t.filename},mouseleave:function(t){e.hover=null},click:function(n){e.popupCenter({url:e.$host+t.filename,title:t.tags.toString(),w:900,h:500})}}},[n("q-img",{attrs:{ratio:16/9,src:e.$host+t.filename}}),n("q-card-actions",[e._l(t.tags,(function(t,a){return n("q-chip",{key:"img"+a+t},[e._v("\n            "+e._s(t)+"\n          ")])})),n("q-space"),n("q-checkbox",{directives:[{name:"show",rawName:"v-show",value:t.selected||e.hover===t.filename,expression:"img.selected || hover === img.filename"}],attrs:{size:"xs"},model:{value:t.selected,callback:function(n){e.$set(t,"selected",n)},expression:"img.selected"}})],2)],1)}))],2)],1)],1)},i=[],o=n("c973"),s=n.n(o),l=(n("d81d"),n("4de4"),n("26e9"),n("fb6a"),n("caad"),n("2532"),n("1276"),n("ac1f"),n("99af"),n("5319"),n("b0c0"),n("d3b7"),n("25f0"),n("96cf"),n("1e48")),c=n("9bcd"),u={name:"MainLayout",created:function(){var e=this;return s()(regeneratorRuntime.mark((function t(){var n,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return window.addEventListener("focus",(function(){e.newWindow&&e.newWindow.close()})),t.next=3,l(e.$realShareHost);case 3:n=t.sent,r=n.imageClassifier,i=n["socket.io-client"],e.imageClassifier=r,console.log("imageClassifier",r),a=new c(i),a.addEventListener("complete",(function(){console.log("complete");var t=e.uploadedFile,n=t.tags,a=t.newName;e.$q.notify({color:"positive",message:"Tags: "+n}),e.images.unshift({filename:a,tags:n,selected:!1}),e.$q.loading.hide()})),e.getImages();case 11:case"end":return t.stop()}}),t)})))()},computed:{filteredImages:function(){var e=this.tags.filter((function(e){return e.value})).map((function(e){return e.label}));return e.length?this.images.filter((function(t){return e.filter((function(e){return t.tags.includes(e)})).length})).slice().reverse():this.images}},methods:{$log:console.log,getImages:function(){var e=this;return s()(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.imageClassifier.getImages();case 2:n=t.sent,e.images=n.map((function(e){var t=e.split(".")[1].split(",");return{tags:t,filename:e,selected:!1}}));case 4:case"end":return t.stop()}}),t)})))()},remove:function(){var e=this;this.$q.dialog({title:"Delete image?",message:"Are you sure you want to delete these images?",ok:{flat:!0,label:"Delete",color:"negative"},cancel:{flat:!0}}).onOk(s()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.imageClassifier.removeImages(e.filteredImages.filter((function(e){return e.selected})).map((function(e){return e.filename})));case 2:return t.next=4,e.getImages();case 4:case"end":return t.stop()}}),t)})))).onCancel((function(){})).onDismiss((function(){}))},popupCenter:function(e){var t=e.url,n=e.title,a=e.w,r=e.h;this.newWindow&&this.newWindow.close();var i=void 0!==window.screenLeft?window.screenLeft:window.screenX,o=void 0!==window.screenTop?window.screenTop:window.screenY,s=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,l=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,c=s/window.screen.availWidth,u=(s-a)/2/c+i,d=(l-r)/2/c+o;this.newWindow=window.open(t,n,"\n        scrollbars=yes,\n        width=".concat(a/c,",\n        height=").concat(r/c,", \n        top=").concat(d,", \n        left=").concat(u,"\n        ")),window.focus&&this.newWindow.focus()},upload:function(e){var t=this;return s()(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:console.log("uploading"),t.$q.loading.show({message:"Analyzing image..."}),console.log(e.target.files[0]);try{r=new FileReader,r.onload=s()(regeneratorRuntime.mark((function n(){var i,o,s,l,c,u,d,g,m;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=r.result.replace(/.*base64,/,""),o={inputs:[{data:{image:{base64:i}}}]},n.next=4,t.$axios.post(t.$url,o,{headers:{Authorization:"Key "+t.$key,"Content-Type":"application/json"}});case 4:if(s=n.sent,console.log(s),console.log(s.data.outputs[0].data.concepts),l=s.data.outputs[0].data.concepts.filter((function(e){return e.value>=.25})),c=1===l.length&&"Pearlite"===l[0].name,!l.length||c){n.next=20;break}return u=l.map((function(e){return e.name})),d=e.target.files[0].name.split("."),g="".concat(s.data.outputs[0].id,".").concat(u.toString(),".").concat(Date.now(),".").concat(d[d.length-1]),m=new File([e.target.files[0]],g),console.log(m),n.next=17,a.submitFiles([m]);case 17:t.uploadedFile={tags:u,newName:g},n.next=22;break;case 20:t.$q.notify({color:"warning",message:"Sorry. Image can't be classified. You may submit more image training set"}),t.$q.loading.hide();case 22:case"end":return n.stop()}}),n)}))),r.readAsDataURL(e.target.files[0])}catch(i){t.$q.notify({color:"negative",message:"Invalid image",icon:"report_problem"}),console.log(i),t.$q.loading.hide()}case 4:case"end":return n.stop()}}),n)})))()}},data:function(){return{newWindow:null,hover:null,leftDrawerOpen:!1,tags:[{label:"Austenite",value:!1},{label:"Carbides",value:!1},{label:"Ferrite",value:!1},{label:"Pearlite",value:!1},{label:"Martensite",value:!1}],images:[]}}},d=u,g=n("2877"),m=n("4d5a"),f=n("e359"),p=n("65c6"),h=n("9c40"),w=n("6ac5"),v=n("9404"),b=n("8f8e"),q=n("1c1c"),x=n("0170"),k=n("eb85"),y=n("66e5"),C=n("09e3"),$=n("2c91"),Q=n("f09f"),I=n("068f"),_=n("4b7e"),D=n("b047"),R=n("eebe"),W=n.n(R),L=Object(g["a"])(d,r,i,!1,null,null,null);t["default"]=L.exports;W()(L,"components",{QLayout:m["a"],QHeader:f["a"],QToolbar:p["a"],QBtn:h["a"],QToolbarTitle:w["a"],QDrawer:v["a"],QCheckbox:b["a"],QList:q["a"],QItemLabel:x["a"],QSeparator:k["a"],QItem:y["a"],QPageContainer:C["a"],QSpace:$["a"],QCard:Q["a"],QImg:I["a"],QCardActions:_["a"],QChip:D["a"]})}}]);
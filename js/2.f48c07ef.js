(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"713b":function(e,t,n){"use strict";n.r(t);var a,r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-layout",{attrs:{view:"hHh Lpr lFf"}},[n("q-header",[n("q-toolbar",{staticClass:"bg-white text-primary shadow-up-12"},[n("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu"},on:{click:function(t){e.leftDrawerOpen=!e.leftDrawerOpen}}}),n("q-toolbar-title",[e._v("\n        Steel.AI\n      ")]),n("div",[e._v("v"+e._s(e.$q.version)+" | "),n("a",{attrs:{target:"_blank",href:"https://trinly01.github.io"}},[e._v("Trinmar Boado")])])],1)],1),n("q-drawer",{attrs:{"show-if-above":"",bordered:"","content-class":"bg-grey-1"},model:{value:e.leftDrawerOpen,callback:function(t){e.leftDrawerOpen=t},expression:"leftDrawerOpen"}},[n("q-list",{attrs:{dense:""}},[n("q-item-label",{staticClass:"text-grey-8",attrs:{header:""}},[e._v("\n        Essential Links\n      ")]),e._l(e.tags,(function(t,a){return n("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:"tag"+a,attrs:{clickable:""}},[n("q-item-section",[n("q-checkbox",{key:"tag"+a,attrs:{label:t.label},model:{value:t.value,callback:function(n){e.$set(t,"value",n)},expression:"tag.value"}})],1),n("q-item-section",{staticClass:"text-grey",attrs:{avatar:""}},[e._v("\n          "+e._s(e.images.filter((function(e){return e.tags.includes(t.label)})).length||"")+"\n        ")])],1)}))],2),n("q-list",{staticClass:"menu-list absolute-bottom",staticStyle:{bottom:"8px"}},[n("q-separator"),n("q-item",{staticClass:"bg-grey-12 text-justify text-caption column"},[e._v("\n        Classifying the Steel Microstructure from Metallographic Images Using Convolutional Neural Network\n      ")])],1)],1),n("q-page-container",[n("q-toolbar",{staticClass:"bg-white text-primary shadow-up-12"},[n("input",{ref:"uploader",attrs:{type:"file",hidden:"",accept:"image/jpeg,image/png"},on:{change:e.upload}}),n("q-btn",{attrs:{stretch:"",flat:"",icon:"add",label:"Add image"},on:{click:function(){e.$refs.uploader.value="",e.$refs.uploader.click()}}}),n("q-btn",{attrs:{stretch:"",flat:"",disabled:!e.filteredImages.filter((function(e){return e.selected})).length,icon:"delete",label:"Delete"},on:{click:e.remove}}),e.filteredImages.filter((function(e){return e.selected})).length?n("q-btn",{attrs:{stretch:"",flat:"",label:"Unselect All"},on:{click:function(t){return e.images.filter((function(e){return e.selected=!1}))}}}):n("q-btn",{attrs:{stretch:"",flat:"",label:"Select All"},on:{click:function(t){return e.images.filter((function(e){return e.selected=!0}))}}}),n("q-space"),n("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"more_vert"}})],1),n("div",{class:"row q-pa-md "+(e.images.length>2||!e.images.length?"flex-center":""),attrs:{"style-fn":function(e){return{minHeight:"calc(100vh - 100px)"}}}},[n("center",{directives:[{name:"show",rawName:"v-show",value:!e.images.length,expression:"!images.length"}],style:{paddingTop:"calc(50vh - 150px)"}},[n("q-btn",{attrs:{stretch:"",icon:"add",label:"Add image",color:"primary"},on:{click:function(){e.$refs.uploader.value="",e.$refs.uploader.click()}}})],1),e._l(e.filteredImages.slice().sort((function(e,t){return parseFloat(t.dateUploaded)-parseFloat(e.dateUploaded)})),(function(t,a){return n("q-card",{key:"img"+a,staticClass:"q-ma-md",staticStyle:{"max-height":"175px",width:"230px"},on:{mouseover:function(n){e.hover=t.filename},mouseleave:function(t){e.hover=null}}},[n("q-img",{attrs:{ratio:16/9,src:e.$host+t.filename},on:{click:function(n){e.popupCenter({url:e.$host+t.filename,title:t.tags.toString(),w:900,h:500})}}}),n("q-card-actions",[e._l(t.tags,(function(t,a){return n("q-chip",{key:"img"+a+t},[e._v("\n            "+e._s(t)+"\n          ")])})),n("q-space"),n("q-checkbox",{directives:[{name:"show",rawName:"v-show",value:t.selected||e.hover===t.filename,expression:"img.selected || hover === img.filename"}],attrs:{size:"xs"},model:{value:t.selected,callback:function(n){e.$set(t,"selected",n)},expression:"img.selected"}}),n("q-btn",{directives:[{name:"show",rawName:"v-show",value:t.score&&t.score.length>1,expression:"img.score && img.score.length > 1"}],staticClass:"absolute",staticStyle:{top:"12px",right:"12px","background-color":"rgba(0, 0, 0, 0.2)"},attrs:{color:"blue-grey-1",round:"",icon:"info",dense:"",flat:""}},[n("q-menu",{attrs:{anchor:"top end",self:"top end"}},[n("q-list",{attrs:{dense:""}},[n("q-item-label",{staticClass:"q-pa-sm text-grey"},[e._v("Predicted Probability")]),n("q-separator"),e._l(t.score,(function(t,r){return n("q-item",{key:"score"+a+"."+r,attrs:{clickable:""}},[n("q-item-section",{staticClass:"column"},[e._v("\n                    "+e._s(t.label)+"\n                  ")]),n("q-item-section",{attrs:{avatar:""}},[n("q-chip",[e._v(e._s(t.value)+"%")])],1)],1)}))],2)],1)],1)],2)],1)}))],2)],1)],1)},i=[],s=n("c973"),o=n.n(s),l=(n("d81d"),n("4de4"),n("26e9"),n("fb6a"),n("caad"),n("2532"),n("1276"),n("ac1f"),n("99af"),n("5319"),n("b0c0"),n("d3b7"),n("25f0"),n("96cf"),n("1e48")),c=n("9bcd"),u={name:"MainLayout",created:function(){var e=this;return o()(regeneratorRuntime.mark((function t(){var n,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return window.addEventListener("focus",(function(){e.newWindow&&e.newWindow.close()})),t.next=3,l(e.$realShareHost);case 3:n=t.sent,r=n.imageClassifier,i=n["socket.io-client"],e.imageClassifier=r,console.log("imageClassifier",r),a=new c(i),a.addEventListener("complete",(function(){console.log("complete");var t=e.uploadedFile,n=t.tags,a=t.score,r=t.newName;e.$q.notify({color:"positive",message:"Tags: "+n}),e.images.unshift({filename:r,tags:n,score:a,selected:!1}),e.$q.loading.hide()})),e.getImages();case 11:case"end":return t.stop()}}),t)})))()},computed:{filteredImages:function(){var e=this.tags.filter((function(e){return e.value})).map((function(e){return e.label}));return e.length?this.images.filter((function(t){return e.filter((function(e){return t.tags.includes(e)})).length})).slice().reverse():this.images}},methods:{$log:console.log,getImages:function(){var e=this;return o()(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.imageClassifier.getImages();case 2:n=t.sent,e.images=n.map((function(e){var t=e.split("."),n=t[1].split(","),a=t[3].split(",").map((function(e){var t=e.split("-");return{label:t[0],value:t[1]}})),r=t[2];return{tags:n,score:a,dateUploaded:r,filename:e,selected:!1}})),e.$forceUpdate();case 5:case"end":return t.stop()}}),t)})))()},remove:function(){var e=this;this.$q.dialog({title:"Delete image?",message:"Are you sure you want to delete these images?",ok:{flat:!0,label:"Delete",color:"negative"},cancel:{flat:!0}}).onOk(o()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.imageClassifier.removeImages(e.filteredImages.filter((function(e){return e.selected})).map((function(e){return e.filename})));case 2:return t.next=4,e.getImages();case 4:case"end":return t.stop()}}),t)})))).onCancel((function(){})).onDismiss((function(){}))},popupCenter:function(e){var t=e.url,n=e.title,a=e.w,r=e.h;this.newWindow&&this.newWindow.close();var i=void 0!==window.screenLeft?window.screenLeft:window.screenX,s=void 0!==window.screenTop?window.screenTop:window.screenY,o=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,l=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,c=o/window.screen.availWidth,u=(o-a)/2/c+i,d=(l-r)/2/c+s;this.newWindow=window.open(t,n,"\n        scrollbars=yes,\n        width=".concat(a/c,",\n        height=").concat(r/c,", \n        top=").concat(d,", \n        left=").concat(u,"\n        ")),window.focus&&this.newWindow.focus()},upload:function(e){var t=this;return o()(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:console.log("uploading"),t.$q.loading.show({message:"Analyzing image..."}),console.log(e.target.files[0]),r=new FileReader,r.onload=o()(regeneratorRuntime.mark((function n(){var i,s,o,l,c,u,d,m,g,f,p;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=r.result.replace(/.*base64,/,""),s={inputs:[{data:{image:{base64:i}}}]},n.prev=2,n.next=5,t.$axios.post(t.$url,s,{headers:{Authorization:"Key "+t.$key,"Content-Type":"application/json"}});case 5:if(o=n.sent,console.log(o),console.log(o.data.outputs[0].data.concepts),l=o.data.outputs[0].data.concepts,c=l.map((function(e){return"".concat(e.name,"-").concat(Math.round(100*e.value))})),u=l.filter((function(e){return e.value>=.3})),d=1===u.length&&"Pearlite"===u[0].name,!u.length||d){n.next=23;break}return m=u.map((function(e){return e.name})),g=e.target.files[0].name.split("."),f="".concat(o.data.outputs[0].id,".").concat(m.toString(),".").concat(Date.now(),".").concat(c.toString(),".").concat(g[g.length-1]),p=new File([e.target.files[0]],f),console.log(p),n.next=20,a.submitFiles([p]);case 20:t.uploadedFile={score:c.map((function(e){var t=e.split("-");return{label:t[0],value:t[1]}})),tags:m,newName:f},n.next=25;break;case 23:t.$q.notify({color:"warning",message:"Sorry. Image can't be classified. You may submit more image training set"}),t.$q.loading.hide();case 25:n.next=32;break;case 27:n.prev=27,n.t0=n["catch"](2),t.$q.notify({color:"negative",message:"Invalid image",icon:"report_problem"}),console.log(n.t0),t.$q.loading.hide();case 32:case"end":return n.stop()}}),n,null,[[2,27]])}))),r.readAsDataURL(e.target.files[0]);case 6:case"end":return n.stop()}}),n)})))()}},data:function(){return{newWindow:null,hover:null,leftDrawerOpen:!1,tags:[{label:"Austenite",value:!1},{label:"Carbides",value:!1},{label:"Ferrite",value:!1},{label:"Pearlite",value:!1},{label:"Martensite",value:!1}],images:[]}}},d=u,m=n("2877"),g=n("4d5a"),f=n("e359"),p=n("65c6"),h=n("9c40"),w=n("6ac5"),v=n("9404"),b=n("8f8e"),q=n("1c1c"),x=n("0170"),k=n("66e5"),y=n("4074"),C=n("eb85"),$=n("09e3"),_=n("2c91"),Q=n("f09f"),I=n("068f"),S=n("4b7e"),D=n("b047"),R=n("4e73"),W=n("714f"),A=n("eebe"),L=n.n(A),F=Object(m["a"])(d,r,i,!1,null,null,null);t["default"]=F.exports;L()(F,"components",{QLayout:g["a"],QHeader:f["a"],QToolbar:p["a"],QBtn:h["a"],QToolbarTitle:w["a"],QDrawer:v["a"],QCheckbox:b["a"],QList:q["a"],QItemLabel:x["a"],QItem:k["a"],QItemSection:y["a"],QSeparator:C["a"],QPageContainer:$["a"],QSpace:_["a"],QCard:Q["a"],QImg:I["a"],QCardActions:S["a"],QChip:D["a"],QMenu:R["a"]}),L()(F,"directives",{Ripple:W["a"]})}}]);